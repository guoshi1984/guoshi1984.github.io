\documentclass[a4paper]{article}
\usepackage{amssymb, amsmath}
\usepackage{graphicx}
\begin{document}
Author: Dr. Shi Guo  \hspace{30mm} Email: guoshi1984@hotmail.com\\
\line(1,0){350}
\section{Basic of Fourier Transform}
{\bf Fourier Series }\\
If $x(t)= x(t+T)$ then $x(t)$ can be written as
\begin{align*}
x(t) = \sum_{-\infty}^{+\infty} c_k e^{\frac{2 \pi i k t}{T}}	
\end{align*}
i is the imaginary unit, and k is an integer. The above expression is eligible because $e^{\frac{2 \pi i k t}{T}}$ is a periodic function 
\begin{align*}
	e^{\frac{2 \pi i k t}{T}} = e^{\frac{2 \pi i k(t+T)}{T}}
\end{align*}
Each basis $e^{\frac{2 \pi i }{T}}$ represents a signal with frequency $f_k = \frac{k}{T}$. So the interval between each adjacent frequency $\Delta f = \frac{1}{T}$.
Based on orthogonality, we can get $c_k$ 
\begin{align*}
	c_k = \frac{1}{T} \int_0^T x(t) e^{-i\frac{2 \pi k t}{T}} dt
\end{align*}
{\bf Fourier Series: Example}\\
\begin{align*}
x(t) = cos(2 \pi f_0 t) = \frac{1}{2} (e^{i 2 \pi f_0 t} + e^{-i 2 \pi f_0 t})
\end{align*}
where $f_0 = \frac{1}{T}$
\begin{align*}
	c_k & = \frac{1}{T} \int_0^T x(t) e^{-i\frac{2 \pi k t}{T}} dt \\
	    & = \frac{1}{T} \int_0^T \frac{1}{2} (e^{\frac{2 i  \pi  t}{T}} 
	      + e^{\frac{- 2i \pi  t}{T}}) e^{-i\frac{2 \pi  k t}{T}} dt 
\end{align*}
Only terms with k = +/-1 in the above expression can survive, so
\begin{align*}
        c_1 = \frac{1}{T} \int_0^T \frac{1}{2} dt = \frac{1}{2}
\end{align*}
Similarly, $c_{-1} = \frac{1}{2}$.\\

{\noindent \bf Fourier Transform}\\
We can generalize the Fourier series to non-periodic functions. We define the Fourier transform as
\begin{align*}
	\mathcal F(f) = \int_{-\infty}^{\infty} x(t) e^{-2 \pi i f t} dt
\end{align*}
With the inverse Fourier transform defined as
\begin{align*}
	x(t) = \int_{-\infty}^{\infty} \mathcal F(f) e^{2 \pi i f t} df
\end{align*}
{\bf Fourier Transform: Example}\\
Take the same x(t) as above
\begin{align*}
x(t) = cos(2 \pi f_0 t) = \frac{1}{2} (e^{2 i \pi f_0 t} + e^{- 2 i \pi f_0 t})
\end{align*}
\begin{align*}
	\mathcal F(f) & = \int_{-\infty}^{\infty} \frac{1}{2} (e^{2 i  \pi f_0 t} + e^{- 2i \pi f_0 t})  e^{- 2 i\pi  f t} dt
	     & = \frac{1}{2}\delta(f - f_0) + \frac{1}{2} \delta(f + f_0)	
\end{align*}
{\bf Discrete Fourier Transform}\\
The above is the Fourier transform in continuous case, in discrete case
If $x = n \Delta t$, where n = 1...N, and $T= N \Delta t$, then the Fourier series can be written as
\begin{align*}
	f(n) & = \sum_{-\infty}^{+\infty} c_k e^{\frac{2 \pi i k n \Delta t}{N \Delta t}}\\
	     & = \sum_{-\infty}^{+\infty} c_k e^{\frac{2 \pi i k n }{N }}\\
\end{align*}
\begin{align*}
	c_k = \frac{1}{N \Delta t} \sum_{n=1}^{N} f(n \Delta t) e^{-i 2\pi k \frac{1}{N\Delta t} n \Delta t} d(n \Delta t)
	=\frac{1}{N} \sum_{n = 1} ^ {N} f(n) e^{-i 2 \pi k \frac{n}{N}}
\end{align*}
This is the discrete Fourier transform.\\
\begin{align*}
	\Delta F = \frac{1}{T} = \frac{1}{N \Delta t}
\end{align*}
{\bf Example\\}
Let N = 4, and \\
\begin{align*}
	f(n) = cos(2 \pi \frac{n}{4}) = \frac{1}{2} (e^{i 2 \pi \frac{n}{4}} + e^{-i 2 \pi \frac{n}{4}})
\end{align*}
\begin{align*}
	c_k & = \frac{1}{4} \sum_{n=1}^4 \frac{1}{2} (e^{i 2 \pi \frac{n}{4} } + e^{-i 2 \pi \frac{n}{4} }) e^{-i\frac{2 \pi k n}{4}} 
\end{align*}
Similary to the continuous case, only terms with k = +/-1  in the above expression can survive, when $k=1$
\begin{align*}
	c_1 & = \frac{1}{4} \sum_{n=1}^4 \frac{1}{2} e^{i 2 \pi \frac{n}{4} } e^{-i\frac{2 \pi n}{4}} \\
	& = \frac{1}{4}\frac{1}{2}4 \\
 	& = \frac{1}{2} \\
\end{align*}
What about case for $k=-1$? We define k = {1, 2, 3, 4} so $k = -1$ is not defined. However, in discrete case we note $c_{-1} = c_{3}$ due to the periodicity.
Similarly, we can calculate $c_{3} = \frac{1}{2}$.\\
N is the total sample within time T.\\
{\bf Properties}\\
\noindent 1) To be eligible, f(x) has to be a period function with time T(with frequency $F=\frac{1}{T}$) in both continuous case and discrete case.  The requirement in discrete case leads to uniform sampling theorem used in signal processing. The total sampling time $T_{sampling}$ has to be an integer multiple of $T$.
\begin{align*}
T_{sampling} = M T 
\end{align*}
while $T= \frac{N}{F_s}$
So
\begin{align*}
	M T = N \Delta t
\end{align*}
if we let $\Delta t= \frac{1}{F_s}$, where $F_s$ is the sampling frequency, and $T=\frac{1}{F}$, we have
\begin{align*}
	\frac{M}{F} = \frac{N}{F_s}
\end{align*}
\noindent 2) If $f(x)$ is real, which means $f(x) = f^{*}(x)$. We then substitute Fourier series for both $f(x)$ and $f*(x)$,  
\begin{align} \label{eq1}
	\sum_{-\infty}^{+\infty} c_k e^{2 \pi i \frac{1}{T} kx} = \sum_{-\infty}^{+\infty} c_k^* e^{-2 \pi i \frac{1}{T} kx}
\end{align}
Since the summation on the right hand side is from $-\infty$ to $\infty$, it is eligible to replace $k$ with $k$.
\begin{align} \label{eq2}
	\sum_{-\infty}^{+\infty} c_k^* e^{-2 \pi i \frac{1}{T} kx}
= \sum_{\infty}^{-\infty} c_{-k}^* e^{2 \pi i \frac{1}{T} kx}
\end{align}
Combine the above two equations \ref{eq1} and \ref{eq2}, we can see $c_k = c_{-k}^*$. This means they are complex conjugate: their magnitude are equal, their phase are opposite.  Namely $||c_k|| = ||c_{-k}||$, $\phi(c_k) = \phi(c_{-k})$.\\
\noindent 3) Connection between complex representation and real representation.\\
We have shown that for real signal $c_k = c_{-k}^*$ and $c_k = |c_k| e^{j \theta_k}$, 
$c_{-k} = |c_k| e^{- j \theta_k}$. And in complex representation, we can combine the term with index k and -k,
\begin{align*}
	c_k e^{j 2 \pi k F_0 t} + c_{-k} e^{- j 2 \pi k F_0 t} = 2 |c_k| cos(2 \pi k F_0 t + \theta_k)
\end{align*}
\begin{align*}
f(x) & = \sum_{-\infty}^{+\infty} c_k e^{\frac{2 \pi i k x}{T}}	 \\
& = c_0 + 2 \sum_{k=1}^{\infty} |c_k| cos(2 \pi k F_0 t + \theta_k) \\
& = a_0 + \sum_{k=1}^{\infty} (a_k cos(2 \pi k F_0 t)  - b_k sin(2 \pi k F_0 t) ) \\
\end{align*}
where $a_0 = c_0$, $a_k = 2 |c_k|cos \theta_k$, $b_k = 2 |c_k| sin \theta_k$. 
\noindent 4) $c_k = c_{k+N}$. So when a signal contains frequency component no larger than $B$, in other words, the bandwidth of the signal is $2B(-B\textrm( to )B)$, then in order to capture the whole bandwidth of the signal, $N \Delta f > 2B$. This leads to Nyquist sampling theorem $F_s > 2B(bandwidth)$.\\
\noindent 5) Power density
\begin{align*}
	P_x & = \frac{1}{T} \int |x(t)|^2 dt \\
	    & = \frac{1}{T} \int x(t) \sum_{-\infty}^{\infty} c_k^* e^{-j 2 \pi k F_0 t} \\
	    & = \sum_{-\infty}^{\infty} c_k^*  [\frac{1}{T} \int x(t) e^{-j 2 \pi k F_0 t}] \\
	    & = \sum_{-\infty}^{\infty} |c_k|^2\\
\end{align*}
When signal is real, then 
\begin{align*}
	P_x & = \sum_{-\infty}^{\infty} |c_k|^2\\
	    & = a_0^2 + \frac{1}{2} \sum_{k=1}^{\infty} (a_k^2 + b_k^2)\\
\end{align*}
\section{Fast Fourier Transform}
\begin{align*}
	X_k =  \sum_{n = 0} ^ {N-1} x_n e^{-i 2 \pi k \frac{n}{N}}
\end{align*}
let
\begin{align*}
	u_k =e^{-i 2 \pi k \frac{n}{N}}
\end{align*}
then we have the basis orthogonality
\begin{align*}
	u_{k1}^T u_{k2} = N \delta_{k_1, k_2}
\end{align*}
We recognize we can write $X_k$ with even index terms and odd index terms
\begin{align*}
	X_k &=  \textrm{ Even index parts } + \textrm{ Odd index parts }\\
	    &= \sum_{m=0} ^{N/2-1} x_{2m} e^{-\frac{2\pi i}{N} 2mk}          
         + \sum_{m=0} ^{N/2-1} x_{2m+1} e^{-\frac{2\pi i}{N} (2m+1)k}\\
        &= \sum_{m=0} ^{N/2-1} x_{2m} e^{-\frac{2\pi i}{N/2} mk}\\
       &\textrm{(We can view this as Fourier Transform of N/2 even indexed points, 
       where k is 0,1¡­N/2)}\\
  			&+  e^{-\frac{2\pi i}{N} k}\\
      &\sum_{m=0} ^{N/2-1}  x_{2m+1} e^{-\frac{2\pi i}{N/2} mk}\\
      &\textrm{(We can view this as Fourier Transform of N/2 odd indexed points, where k is 0,1¡­N/2)}\\
      &\textrm{(Since each part is a Fourier transform of N/2 points, k has to be smaller than N/2)}\\
      &= E_k + e^{-\frac{2\pi i}{N} k} O_k
\end{align*}
As noted, the above derivation is for $k<N/2$, a very similar derivation for $N/2<=k<N$ leads to 
\begin{align*}
	X_{k+N/2} =  E_k - e^{-\frac{2\pi i}{N} k} O_k
\end{align*}
Now we have divided the FFT of N points to two FFT with N/2 points
Keep going till we reach the size to one, then combine together recursively.
\section{Fourier Transform of Useful Functions}
{\bf The Fourier Transform of Gaussian}\\
\begin{align*}
	f(t) = \frac{1}{\sqrt{2\pi \sigma^2}} e^{-\frac{t^2}{2\sigma^2}}
\end{align*}
\begin{align*}
	\mathcal F(f) = e^{-2 \pi^2 \sigma^2 f^2}
\end{align*}
So the Fourier transform of a Gaussian function is another Gaussian function but with different width.\\

{\noindent \bf The Fourier Transform of Dirac Comb} \\
\begin{align*}
	x(t) = \sum_{n = -\infty} ^{\infty} \delta(t - n T)
\end{align*}
It is clearly that x(t) is periodic with period T. So we can expand that into Fourier series
\begin{align*}
	x(t) = \sum_{k = -\infty}^{\infty} c_k e^{2\pi i k t/T}
\end{align*}
Where 
\begin{align*}
	c_k & = \frac{1}{T} \int_{-T/2}^{T/2} x(t) e^{-i\frac{2 \pi k t}{T}} dt \\
	    & = \frac{1}{T} \int_{-T/2}^{T/2} \delta(0) e^{-i\frac{2 \pi k t}{T}} \\
	    & = \frac{1}{T}\\
\end{align*}
So 
\begin{align*} 
	x(t) = \sum_{k = -\infty}^{\infty} \frac{1}{T} e^{2\pi i k t/T}
\end{align*}
On the other hand, based on the formula of Fourier transform
\begin{align*}
	\mathcal F(f) & = \int \sum_{n = -\infty} ^{\infty} \delta(t - n T) e^{-2\pi i f t} dt 
		      & = \sum_{n = -\infty} ^{\infty} e^{-2\pi i  n T f}
		      & = \sum_{n = -\infty} ^{\infty} e^{-2\pi i  n f /f_0 }
\end{align*}
Comparing the Fourier series of x(t) and the expression of F(f), they are the same except T being changed to $f_0$. Therefore we can conclude that F(f) itself is also a Dirac comb, which is
\begin{align*}
	\mathcal F(f) = f_0 \sum_{n = -\infty} ^{\infty} \delta(f - nf_0)
\end{align*}
{\bf The Fourier Transform of White Noise}\\
Assuming noise we sample in time is $n[m]$, where m = 0,... M-1. $n[m]$ is a Gaussian random variable with zero mean and variance $\sigma^2$. The the FFT of $n[m]$ is
\begin{align*}
        N[k] &= \frac{1}{M}\sum_{m=0}^{M-1} n[m] e^{-i2\pi m k/M}\\
             &= \frac{1}{M}\sum_{m=0}^{M-1} n[m] (cos(2\pi m k/M) - i \textrm{ }n[m] sin(2\pi m k/M))\\
\end{align*}
The expected value is
\begin{align*}
        E[N[k]] & = E[\frac{1}{M} \sum_0^{M-1} n[m] e^{-i2\pi m k/M}]\\
                        & = \frac{1}{M}\sum_0^{M-1} E[n[m]] e^{-i2\pi m k/M}] \\
                        & = 0 \textrm{(because E[n[m]] = 0)} \\
\end{align*}
The variance of the real part is
\begin{align*}
        Var[R[N[k]]] & = E[(\frac{1}{M}\sum_{m=0}^{M-1} n[m] (cos(2\pi m k/M))
        *(\frac{1}{M}\sum_{p=0}^{M-1} n[p] (cos(2\pi p k/M))]\\
                     & = \frac{1}{M^2}
                     E[\sum_{m=0}^{M-1} n[m] n[p] \delta(n-p) cos(2\pi m k/M)* cos(2\pi p k/M)]\\
                     & = \frac{1}{M^2} \sum_{m=0}^{M-1} E[n[m]^2]  cos^2(2\pi m k/M) \\
                     & = \frac{1}{M^2} \sigma^2(\sum_{m=0}^{M-1}  cos^2(2\pi m k/M)) \\
                     & = \frac{1}{M^2} \sigma^2(\frac{M}{2} + \frac{cos((M+1)2 \pi k/M) sin(2 \pi M k /M)}{2sin(2 \pi k /M)})\\
                                 & = \frac{1}{M} \frac{\sigma^2}{2}
\end{align*}
The same derivation applies for the imaginary part. So the FFT is Gaussian noise with mean zero and variance $\sigma^2$.\\
\section{Connection with Uncertainty Principle}
{\bf Relationship between time length and frequency bandwidth}\\
We consider a few examples\\
1) We consider a function g(t) which is infinitely long in time domain\\
\begin{align*}
	g(t) = cos(2\pi f_0 t)
\end{align*}
Its Fourier transform is 
\begin{align*}
	F(f) & = \int \frac{e^{i2\pi f_0 t} + e^{-i2\pi f_0 t}}{2} e^{i 2 \pi f t} dt \\
		 & = \int \frac{1}{2} e^{i2\pi t (f_0  + f)} dt + \int \frac{1}{2} e^{i2\pi t (f - f_0)} dt \\ 	
		 & = \frac{1}{2} \delta(f+f_0) + \frac{1}{2} \delta(f - f_0) \\     
\end{align*}
The last line is based on $\int_{-\infty}^{\infty}e^{i2 \pi f t}  = \delta (f)$.\\
Since the delta function has width zero, so the the bandwidth in frequency domain is zero. We see a signal which is infinitely long in time domain has zero bandwidth in frequency domain. \\
2) We consider a function g(t) which has zero width in time, namely an impulse function.\\
\begin{align*}
	g(t) = \delta(t)
\end{align*}
Since this function is not a periodic function, we assume its period is infinity. Its Fourier transform is 
\begin{align*}
	F(f) = \int_{-\infty}^{\infty} \delta(t) e^{-2\pi f t} = 1
\end{align*}
Now we see a signal which has zero width in time has infinitely long frequency bandwidth. This leads to the uncertainty principle.\\
{\bf Uncertainty Principle}
In quantum mechanics, if there is a particle with position x and momentum p, then uncertainty principle states
\begin{align*}
	\Delta x \Delta p \geq \frac{\hbar}{2}
\end{align*}
Similar relationship holds for time t and Energy.
\begin{align*}
	\Delta t \Delta E \geq \frac{\hbar}{2}
\end{align*}
We can modify this expression to get the time and frequency relationship in our Fourier transform. Since 
$E = \hbar \omega$. Then 
\begin{align*}
	\Delta t \Delta \omega \geq \frac{1}{2}
\end{align*}
\end{document}
